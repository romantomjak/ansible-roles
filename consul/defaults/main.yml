---
# Override these in playbook with 'vars:' block

# Consul is supported on amd64 and arm64 architectures
consul_architecture: amd64

# Controls whether an agent is in server or client mode.
consul_agent_type: server

# The data center in which the agent is running. In most cases, a Consul
# datacenter is a single physical datacenter or a cloud region. The underlying
# philosophy is that a Consul datacenter is a LAN construct and is optimized
# for LAN latency. 
consul_datacenter: dc1

# Designates the datacenter which is authoritative for ACL information,
# intentions and is the root Certificate Authority for Connect.
consul_primary_datacenter: "{{ consul_datacenter }}"

# The data directory for the agent to store state. This is required for all
# agents. The directory should be durable across reboots.
consul_data_dir: /opt/consul

# The number of Consul servers you will use; three or five is recommended for
# reliable Raft consensus algorithm operation.
consul_bootstrap_expect: 3

# Specifies if the agent should log to syslog.
consul_enable_syslog: false

# The secret key to use for encryption of Consul network traffic.
consul_encrypt: Luj2FZWwlt8475wD1WtwUQ==

# The addresses of upstream DNS servers that are used to recursively resolve
# queries when Consul is used as the DNS server for a node. If the record is 
# outside of the "consul." domain, the query will be resolved upstream.
consul_recursors:

# Addresses of other agents to join upon starting up. By default, the agent
# won't join any nodes when it starts up.
consul_retry_join:

# The address that should be bound to for internal cluster communications.
# By default, Consul will bind to all addresses on the local machine and
# will advertise the private IPv4 address to the rest of the cluster.
consul_bind_addr: 0.0.0.0

# The address to which Consul will bind client interfaces, including the HTTP,
# HTTPS, gRPC and DNS servers. By default, allowing only loopback connections.
consul_client_addr: 127.0.0.1

# Nested dictionary that allows setting the bind ports. Setting a port to -1
# disables the port. See https://www.consul.io/docs/agent/options.html#ports
consul_ports:
  dns: 8600
  http: 8500
  https: -1
  grpc: -1
  serf_lan: 8301
  serf_wan: 8302
  server: 8300
  sidecar_min_port: 21000
  sidecar_max_port: 21255
  expose_min_port: 21500
  expose_max_port: 21755

# Enables the built-in web UI server.
consul_ui_enabled: false

# Controls whether Connect features are enabled on this agent. Should be enabled
# on all servers in the cluster in order for Connect to function properly.
consul_connect_enabled: false

# Enables ACLs.
consul_acl_enabled: false

# Determines whitelist or blacklist mode
# In "allow" mode, ACLs are a blacklist: any operation not specifically
# prohibited is allowed. In "deny" mode, ACLs are a whitelist: any operation
# not specifically allowed is blocked
consul_acl_default_policy: allow

# In the case that a policy or token cannot be read from the primary_datacenter
# Can be either "allow", "deny", "extend-cache" or "async-cache".
consul_acl_down_policy: extend-cache

# Only used for servers in the primary_datacenter. This token will be created
# with management-level permissions if it does not exist. It allows operators
# to bootstrap the ACL system with a token ID that is well-known.
consul_acl_initial_management_token: b1gs33cr3t

# The agent token is a special token that is used for an agent's internal 
# operations. It isn't used directly for any user-initiated operations. When
# this token is not provided and ACLs are enabled, a unique token will be
# generated for each agent and applied to it's configuration.
consul_acl_agent_token: 

# Default token to use for client requests where no token is supplied. This is
# often configured with read-only access to services to enable DNS service
# discovery on agents. When not provided, ACLs for service DNS resolution will
# be assigned to the Anonymous token.
consul_acl_token_default: 

# PEM-encoded certificate authority. The certificate authority is used to check
# the authenticity of client and server connections.
consul_tls_ca_cert: |
  -----BEGIN CERTIFICATE-----
  MIIBjjCCATSgAwIBAgIJAPyJcuHgvkLGMAoGCCqGSM49BAMCMBoxGDAWBgNVBAMM
  D0NvbnN1bCBBZ2VudCBDQTAeFw0yMjAxMTcwMDE4NThaFw0yNzAxMTYwMDE4NTha
  MBoxGDAWBgNVBAMMD0NvbnN1bCBBZ2VudCBDQTBZMBMGByqGSM49AgEGCCqGSM49
  AwEHA0IABNor0rURLoR9VoQbMUCxqkjRdAzY4qhs+tUq23wttcbi3uMKWpXg7HrC
  Urr2GXVOqqZdV9BBCAMsHx0ZF/j8+XWjYzBhMA8GA1UdEwEB/wQFMAMBAf8wDgYD
  VR0PAQH/BAQDAgGGMB0GA1UdDgQWBBQ0DgPIcyWuzsZLOH+9seIH5MYGjjAfBgNV
  HSMEGDAWgBQ0DgPIcyWuzsZLOH+9seIH5MYGjjAKBggqhkjOPQQDAgNIADBFAiEA
  3ns7GQtS66MUJCrc7qCpYOR1ae0UW8ZeceqBvOnvJScCIF+iWfInvmfpo0WTIyQW
  iZQV8MKHTirYXt4SsYvQ9mJW
  -----END CERTIFICATE-----

# PEM-encoded private key of certificate authority. Any certificate signed
# by the CA will be allowed to communicate with the cluster and a specially
# crafted certificate signed by the CA can be used to gain full access to
# Consul. Keep this private, for example in an ansible-vault. The key is
# hardcoded here for easy bootstrapping of tls encryption.
consul_tls_ca_key: |
  -----BEGIN EC PRIVATE KEY-----
  MHcCAQEEIOAv6aWVGGWTROOdn93dSdU4hlC9sCPC/APWpeat98LqoAoGCCqGSM49
  AwEHoUQDQgAE2ivStREuhH1WhBsxQLGqSNF0DNjiqGz61SrbfC21xuLe4wpaleDs
  esJSuvYZdU6qpl1X0EEIAywfHRkX+Pz5dQ==
  -----END EC PRIVATE KEY-----
